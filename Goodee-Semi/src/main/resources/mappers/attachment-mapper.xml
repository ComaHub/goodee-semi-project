<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goodee.semi.mapper.AttachmentMapper">

	<resultMap id="AttachmentResultMap" type="com.goodee.semi.dto.Attachment">
		<result property="attachNo" column="attach_no" />
		<result property="typeNo" column="type_no" />
		<result property="pkNo" column="pk_no" />
		<result property="oriName" column="ori_name" />
		<result property="saveName" column="save_name" />
	</resultMap>
	
	<update id="updateAttachment" parameterType="com.goodee.semi.dto.Attachment">
		UPDATE attachment
		<set>
		  <if test="oriName != null"> ori_name = #{oriName}, </if>
		  <if test="saveName != null"> save_name = #{saveName}, </if>
		  type_no = type_no
		</set>
		<where>
		  type_no = #{typeNo}
		  AND pk_no = #{pkNo}
		</where>
	</update>
	
	<delete id="deleteAttachment" parameterType="_int">
		DELETE a
		FROM attachment a
		JOIN (
			SELECT attach_no
			FROM attachment
			WHERE pk_no = #{pet_no}
			) b
			ON a.attach_no = b.attach_no;
	</delete>
	
	<insert id="insertAttachment" parameterType="com.goodee.semi.dto.Attachment">
		INSERT INTO attachment (attach_no, type_no, pk_no, ori_name, save_name)
		VALUES (#{attachNo}, #{typeNo}, #{pkNo}, #{oriName}, #{saveName});
	</insert>
</mapper>